<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PivotTable.js</title>

    <!-- external libs -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/pivot.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/pivot.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/d3_renderers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/c3_renderers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/export_renderers.min.js"></script>
</head>

<body>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<script>
$(function(){

    $("#Returns_Over_Last_Few_Days").pivotUI(
                        $.csv.toArrays($("#stockReturns").text()),
                        $.extend({
                            renderers: $.extend(
                                $.pivotUtilities.renderers,
                                $.pivotUtilities.c3_renderers,
                                $.pivotUtilities.d3_renderers,
                                $.pivotUtilities.export_renderers
                                ),
                            hiddenAttributes: [""]
                        }, {"rendererName":"Heatmap","rows":["Symbol"],"aggregatorName":"Average","vals":["Return"],"rendererOptions":{ heatmap: { colorScaleGenerator: function(values) { return Plotly.d3.scale.linear().domain([-0.05, 0.0, 0.05]).range(["#9e0303", "#ffffff", "#00e32d"])}}},"cols":["Date"],"exclusions":{"Symbol":["MSFT"]}})
                    );
    $("#Correlation_Matrix").pivotUI(
                        $.csv.toArrays($("#correlations").text()),
                        $.extend({
                            renderers: $.extend(
                                $.pivotUtilities.renderers,
                                $.pivotUtilities.c3_renderers,
                                $.pivotUtilities.d3_renderers,
                                $.pivotUtilities.export_renderers
                                ),
                            hiddenAttributes: [""]
                        }, {"rendererName":"Heatmap","rows":["Symbol1"],"aggregatorName":"Average","vals":["Correlation"],"rendererOptions":{ heatmap: { colorScaleGenerator: function(values) { return Plotly.d3.scale.linear().domain([-1.0, 0.0, 1.0]).range(["#FF4545", "#ffffff", "#4F92FF"])}}},"cols":["Symbol2"]})
                    );


});
</script>

<!-- DATASETS -->

<div id="stockReturns" style="display: none;">Symbol,Date,Return
RTX,2023-01-01,0.01
RTX,2023-01-02,-0.005
RTX,2023-01-03,0.002
GOOG,2023-01-01,0.015
GOOG,2023-01-02,0.01
GOOG,2023-01-03,-0.003
MSFT,2023-01-01,0.008
MSFT,2023-01-02,0.004
MSFT,2023-01-03,-0.002
</div><div id="correlations" style="display: none;">Symbol1,Symbol2,Correlation
RTX,GOOG,-0.85
RTX,MSFT,-0.75
GOOG,MSFT,0.8
RTX,RTX,1.0
GOOG,GOOG,1.0
MSFT,MSFT,1.0
GOOG,RTX,-0.85
MSFT,RTX,-0.75
MSFT,GOOG,0.8
</div>

<!-- PIVOT TABLES -->

    <h2>Returns_Over_Last_Few_Days</h2>
    <div id="Returns_Over_Last_Few_Days"></div>

    <br><hr><br>
    <h2>Correlation_Matrix</h2>
    <div id="Correlation_Matrix"></div>

    <br><hr><br>


</body>
</html>
