<!DOCTYPE html>
<html>
<head>
    <title>Space Test</title>
    <meta charset="UTF-8">
    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apache-arrow@14.0.1/Arrow.es2015.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        #controls {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        #$div_id {
            width: 100%;
            height: 600px;
        }
    </style>
    

    <!-- external libs -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/pivot.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/pivot.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/d3_renderers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/c3_renderers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pivottable/2.19.0/export_renderers.min.js"></script>
</head>

<body>

<script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>

<script type="module">
// Import parquet-wasm for Parquet file support
import * as parquet from 'https://unpkg.com/parquet-wasm@0.6.1/esm/parquet_wasm.js';

// Initialize parquet-wasm
await parquet.default();

// Make parquet available globally for loadDataset
window.parquetWasm = parquet;
window.parquetReady = true;
console.log('Parquet-wasm library loaded successfully');
</script>

<script>
// Helper function to wait for parquet-wasm to be loaded
function waitForParquet() {
    return new Promise(function(resolve) {
        if (window.parquetReady) {
            resolve();
            return;
        }
        var checkInterval = setInterval(function() {
            if (window.parquetReady) {
                clearInterval(checkInterval);
                resolve();
            }
        }, 50);
    });
}

// Centralized data loading function
// This function parses data from embedded or external sources and returns a Promise
// Supports CSV (embedded/external), JSON (embedded/external), and Parquet (external) formats
// Usage: loadDataset('dataLabel').then(function(data) { /* use data */ });
function loadDataset(dataLabel) {
    return new Promise(function(resolve, reject) {
        var dataElement = document.getElementById(dataLabel);
        if (!dataElement) {
            reject(new Error('Data element not found: ' + dataLabel));
            return;
        }

        var format = dataElement.getAttribute('data-format') || 'csv_embedded';
        var dataSrc = dataElement.getAttribute('data-src');

        // Handle external JSON files
        if (format === 'json_external' && dataSrc) {
            fetch(dataSrc)
                .then(function(response) {
                    if (!response.ok) {
                        throw new Error('Failed to load ' + dataSrc + ': ' + response.statusText);
                    }
                    return response.json();
                })
                .then(function(data) {
                    resolve(data);
                })
                .catch(function(error) {
                    console.error('Error loading external JSON:', error);
                    reject(error);
                });
            return;
        }

        // Handle external Parquet files
        if (format === 'parquet' && dataSrc) {
            // Wait for parquet-wasm to be loaded first
            waitForParquet()
                .then(function() {
                    return fetch(dataSrc);
                })
                .then(function(response) {
                    if (!response.ok) {
                        throw new Error('Failed to load ' + dataSrc + ': ' + response.statusText);
                    }
                    return response.arrayBuffer();
                })
                .then(function(arrayBuffer) {
                    // Use parquet-wasm to read the file
                    var uint8Array = new Uint8Array(arrayBuffer);

                    // readParquet returns an Arrow Table
                    var wasmTable = window.parquetWasm.readParquet(uint8Array);

                    // Convert to Arrow IPC stream
                    var ipcStream = wasmTable.intoIPCStream();

                    // Use Apache Arrow JS to read the IPC stream
                    var arrowTable = window.Arrow.tableFromIPC(ipcStream);

                    // Convert Arrow Table to array of JavaScript objects
                    var data = [];
                    for (var i = 0; i < arrowTable.numRows; i++) {
                        var row = {};
                        arrowTable.schema.fields.forEach(function(field) {
                            var column = arrowTable.getChild(field.name);
                            var value = column.get(i);

                            // Convert BigInt to Number (Arrow returns BigInt for Int64)
                            if (typeof value === 'bigint') {
                                value = Number(value);
                            }

                            row[field.name] = value;
                        });
                        data.push(row);
                    }

                    resolve(data);
                })
                .catch(function(error) {
                    console.error('Error loading external Parquet:', error);
                    reject(error);
                });
            return;
        }

        // Handle external CSV files
        if (format === 'csv_external' && dataSrc) {
            fetch(dataSrc)
                .then(function(response) {
                    if (!response.ok) {
                        throw new Error('Failed to load ' + dataSrc + ': ' + response.statusText);
                    }
                    return response.text();
                })
                .then(function(csvText) {
                    Papa.parse(csvText, {
                        header: true,
                        dynamicTyping: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            // Check for fatal errors only (not warnings)
                            var fatalErrors = results.errors.filter(function(err) {
                                return err.type !== 'Delimiter';
                            });

                            if (fatalErrors.length > 0) {
                                console.error('CSV parsing errors:', fatalErrors);
                                reject(fatalErrors);
                            } else if (results.data && results.data.length > 0) {
                                resolve(results.data);
                            } else {
                                reject(new Error('No data parsed from CSV'));
                            }
                        },
                        error: function(error) {
                            console.error('CSV parsing error:', error);
                            reject(error);
                        }
                    });
                })
                .catch(function(error) {
                    console.error('Error loading external CSV:', error);
                    reject(error);
                });
            return;
        }

        // Handle embedded data
        var dataText = dataElement.textContent.trim();

        if (format === 'json_embedded') {
            // Parse JSON data
            try {
                var data = JSON.parse(dataText);
                resolve(data);
            } catch (error) {
                console.error('JSON parsing error:', error);
                reject(error);
            }
        } else if (format === 'csv_embedded') {
            // Parse CSV data using PapaParse
            Papa.parse(dataText, {
                header: true,
                dynamicTyping: true,
                skipEmptyLines: true,
                complete: function(results) {
                    // Check for fatal errors only (not warnings)
                    // PapaParse includes non-fatal warnings in errors array
                    var fatalErrors = results.errors.filter(function(err) {
                        // Filter out delimiter detection warnings - these aren't fatal
                        // (common for single-column CSVs)
                        return err.type !== 'Delimiter';
                    });

                    if (fatalErrors.length > 0) {
                        console.error('CSV parsing errors:', fatalErrors);
                        reject(fatalErrors);
                    } else if (results.data && results.data.length > 0) {
                        resolve(results.data);
                    } else {
                        reject(new Error('No data parsed from CSV'));
                    }
                },
                error: function(error) {
                    console.error('CSV parsing error:', error);
                    reject(error);
                }
            });
        } else {
            reject(new Error('Unsupported data format: ' + format));
        }
    });
}

$(function(){

    (function() {
    window.showEigenvectors_My_3D_Chart___Test = true;
    window.sharedCamera_My_3D_Chart___Test = true; // Always use shared camera
    window.currentCamera_My_3D_Chart___Test = null;
    const DEFAULT_X_COL = 'x';
    const DEFAULT_Y_COL = 'y';
    const DEFAULT_Z_COL = 'z';
    const DEFAULT_COLOR_COL = 'category';

    const getCol = (id, def) => { const el = document.getElementById(id); return el ? el.value : def; };

    // Eigenvector toggle
    document.getElementById('My_3D_Chart___Test_eigenvector_toggle').addEventListener('click', function() {
        window.showEigenvectors_My_3D_Chart___Test = !window.showEigenvectors_My_3D_Chart___Test;
        this.textContent = window.showEigenvectors_My_3D_Chart___Test ? 'Hide Eigenvectors' : 'Show Eigenvectors';
        updatePlotWithFilters_My_3D_Chart___Test();
    });

    function computeEigenvectors(data, X_COL, Y_COL, Z_COL) {
        // Extract numeric data
        const xs = data.map(row => parseFloat(row[X_COL]));
        const ys = data.map(row => parseFloat(row[Y_COL]));
        const zs = data.map(row => parseFloat(row[Z_COL]));

        // Compute means
        const meanX = xs.reduce((a, b) => a + b, 0) / xs.length;
        const meanY = ys.reduce((a, b) => a + b, 0) / ys.length;
        const meanZ = zs.reduce((a, b) => a + b, 0) / zs.length;

        // Center the data
        const centeredX = xs.map(x => x - meanX);
        const centeredY = ys.map(y => y - meanY);
        const centeredZ = zs.map(z => z - meanZ);

        // Compute covariance matrix
        const n = xs.length;
        const cov = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];

        for (let i = 0; i < n; i++) {
            cov[0][0] += centeredX[i] * centeredX[i];
            cov[0][1] += centeredX[i] * centeredY[i];
            cov[0][2] += centeredX[i] * centeredZ[i];
            cov[1][0] += centeredY[i] * centeredX[i];
            cov[1][1] += centeredY[i] * centeredY[i];
            cov[1][2] += centeredY[i] * centeredZ[i];
            cov[2][0] += centeredZ[i] * centeredX[i];
            cov[2][1] += centeredZ[i] * centeredY[i];
            cov[2][2] += centeredZ[i] * centeredZ[i];
        }

        for (let i = 0; i < 3; i++) {
            for (let j = 0; j < 3; j++) {
                cov[i][j] /= n;
            }
        }

        // Power iteration for first eigenvector
        let v1 = [1, 0, 0];
        for (let iter = 0; iter < 20; iter++) {
            const newV = [
                cov[0][0] * v1[0] + cov[0][1] * v1[1] + cov[0][2] * v1[2],
                cov[1][0] * v1[0] + cov[1][1] * v1[1] + cov[1][2] * v1[2],
                cov[2][0] * v1[0] + cov[2][1] * v1[1] + cov[2][2] * v1[2]
            ];
            const norm = Math.sqrt(newV[0]**2 + newV[1]**2 + newV[2]**2);
            v1 = [newV[0]/norm, newV[1]/norm, newV[2]/norm];
        }

        // Second eigenvector (orthogonal to first)
        let v2 = [0, 1, 0];
        const dot12 = v2[0]*v1[0] + v2[1]*v1[1] + v2[2]*v1[2];
        v2 = [v2[0] - dot12*v1[0], v2[1] - dot12*v1[1], v2[2] - dot12*v1[2]];
        const norm2 = Math.sqrt(v2[0]**2 + v2[1]**2 + v2[2]**2);
        v2 = [v2[0]/norm2, v2[1]/norm2, v2[2]/norm2];

        // Third eigenvector (cross product)
        const v3 = [
            v1[1]*v2[2] - v1[2]*v2[1],
            v1[2]*v2[0] - v1[0]*v2[2],
            v1[0]*v2[1] - v1[1]*v2[0]
        ];

        // Compute fixed scale (20% of average data range)
        const xRange = Math.max(...xs) - Math.min(...xs);
        const yRange = Math.max(...ys) - Math.min(...ys);
        const zRange = Math.max(...zs) - Math.min(...zs);
        const fixedScale = (xRange + yRange + zRange) / 3 * 0.2;

        return {
            center: [meanX, meanY, meanZ],
            vectors: [v1, v2, v3],
            scale: fixedScale
        };
    }

    function createEigenvectorTraces(eigData, sceneId) {
        const traces = [];
        const colors = ['red', 'green', 'blue'];
        const [cx, cy, cz] = eigData.center;

        eigData.vectors.forEach((vec, idx) => {
            traces.push({
                x: [cx, cx + vec[0] * eigData.scale],
                y: [cy, cy + vec[1] * eigData.scale],
                z: [cz, cz + vec[2] * eigData.scale],
                mode: 'lines+markers',
                type: 'scatter3d',
                name: `PC${idx + 1}`,
                legendgroup: `PC${idx + 1}`,
                scene: sceneId,
                line: { color: colors[idx], width: 6 },
                marker: { size: 6, symbol: 'diamond' },
                showlegend: idx === 0 || sceneId === 'scene'
            });
        });

        return traces;
    }

    function updateChart_My_3D_Chart___Test(dataOverride) {
        const data = dataOverride || window.allData_My_3D_Chart___Test;
        const X_COL = getCol('My_3D_Chart___Test_x_col_select', DEFAULT_X_COL);
        const Y_COL = getCol('My_3D_Chart___Test_y_col_select', DEFAULT_Y_COL);
        const Z_COL = getCol('My_3D_Chart___Test_z_col_select', DEFAULT_Z_COL);
        const COLOR_COL = getCol('My_3D_Chart___Test_color_col_select', DEFAULT_COLOR_COL);

        // Get facet selections
        const FACET1_COL = getCol('facet1_select_My_3D_Chart___Test', 'None');
        const FACET2_COL = getCol('facet2_select_My_3D_Chart___Test', 'None');

        if (FACET1_COL === 'None' && FACET2_COL === 'None') {
            renderNoFacets_My_3D_Chart___Test(data, X_COL, Y_COL, Z_COL, COLOR_COL);
        } else if (FACET1_COL !== 'None' && FACET2_COL === 'None') {
            renderFacetWrap_My_3D_Chart___Test(data, X_COL, Y_COL, Z_COL, COLOR_COL, FACET1_COL);
        } else if (FACET1_COL !== 'None' && FACET2_COL !== 'None') {
            renderFacetGrid_My_3D_Chart___Test(data, X_COL, Y_COL, Z_COL, COLOR_COL, FACET1_COL, FACET2_COL);
        } else {
            renderFacetWrap_My_3D_Chart___Test(data, X_COL, Y_COL, Z_COL, COLOR_COL, FACET2_COL);
        }
    }

    function renderNoFacets_My_3D_Chart___Test(data, X_COL, Y_COL, Z_COL, COLOR_COL) {
        const groups = {};
        data.forEach(row => {
            const key = row[COLOR_COL];
            if (!groups[key]) groups[key] = [];
            groups[key].push(row);
        });

        const traces = Object.entries(groups).map(([key, groupData]) => ({
            x: groupData.map(d => parseFloat(d[X_COL])),
            y: groupData.map(d => parseFloat(d[Y_COL])),
            z: groupData.map(d => parseFloat(d[Z_COL])),
            mode: 'markers',
            name: key,
            type: 'scatter3d',
            marker: {
                size: 4,
                opacity: 0.6
            }
        }));

        if (window.showEigenvectors_My_3D_Chart___Test && data.length > 3) {
            const eigData = computeEigenvectors(data, X_COL, Y_COL, Z_COL);
            traces.push(...createEigenvectorTraces(eigData, 'scene'));
        }

        const layout = {
            title: 'Testing Chart Title with Spaces',
            autosize: true,
            showlegend: true,
            scene: {
                xaxis: { title: X_COL },
                yaxis: { title: Y_COL },
                zaxis: { title: Z_COL },
                camera: window.currentCamera_My_3D_Chart___Test || undefined
            },
            margin: { t: 50, r: 50, b: 50, l: 50 }
        };

        Plotly.react('My_3D_Chart___Test', traces, layout, {responsive: true});

        // Store current camera
        const plotDiv = document.getElementById('My_3D_Chart___Test');
        plotDiv.on('plotly_relayout', (eventData) => {
            if (eventData['scene.camera']) {
                window.currentCamera_My_3D_Chart___Test = eventData['scene.camera'];
            }
        });
    }

    function renderFacetWrap_My_3D_Chart___Test(data, X_COL, Y_COL, Z_COL, COLOR_COL, FACET_COL) {
        const facetValues = [...new Set(data.map(row => row[FACET_COL]))].sort();
        const nFacets = facetValues.length;
        const cols = Math.ceil(Math.sqrt(nFacets));
        const rows = Math.ceil(nFacets / cols);

        const traces = [];

        facetValues.forEach((facetVal, idx) => {
            const facetData = data.filter(row => row[FACET_COL] === facetVal);
            const sceneId = idx === 0 ? 'scene' : 'scene' + (idx + 1);

            const groups = {};
            facetData.forEach(row => {
                const key = row[COLOR_COL];
                if (!groups[key]) groups[key] = [];
                groups[key].push(row);
            });

            Object.entries(groups).forEach(([key, groupData]) => {
                traces.push({
                    x: groupData.map(d => parseFloat(d[X_COL])),
                    y: groupData.map(d => parseFloat(d[Y_COL])),
                    z: groupData.map(d => parseFloat(d[Z_COL])),
                    mode: 'markers',
                    name: key,
                    legendgroup: key,
                    showlegend: idx === 0,
                    scene: sceneId,
                    type: 'scatter3d',
                    marker: {
                        size: 4,
                        opacity: 0.6
                    }
                });
            });

            if (window.showEigenvectors_My_3D_Chart___Test && facetData.length > 3) {
                const eigData = computeEigenvectors(facetData, X_COL, Y_COL, Z_COL);
                traces.push(...createEigenvectorTraces(eigData, sceneId));
            }
        });

        const layout = {
            title: 'Testing Chart Title with Spaces',
            showlegend: true,
            grid: { rows: rows, columns: cols, pattern: 'independent' },
            annotations: []
        };

        // Create scene for each facet
        facetValues.forEach((val, idx) => {
            const row = Math.floor(idx / cols);
            const col = idx % cols;
            const sceneKey = idx === 0 ? 'scene' : 'scene' + (idx + 1);

            const xDomain = [col / cols + 0.01, (col + 1) / cols - 0.01];
            const yDomain = [1 - (row + 1) / rows + 0.01, 1 - row / rows - 0.01];

            layout[sceneKey] = {
                domain: { x: xDomain, y: yDomain },
                xaxis: { title: X_COL },
                yaxis: { title: Y_COL },
                zaxis: { title: Z_COL },
                camera: window.sharedCamera_My_3D_Chart___Test ? (window.currentCamera_My_3D_Chart___Test || undefined) : undefined
            };

            layout.annotations.push({
                text: FACET_COL + ': ' + val,
                showarrow: false,
                xref: sceneKey + ' domain',
                yref: sceneKey + ' domain',
                x: 0.5,
                y: 1.05,
                xanchor: 'center',
                yanchor: 'bottom'
            });
        });

        Plotly.react('My_3D_Chart___Test', traces, layout, {responsive: true});

        // Setup camera sync if shared
        if (window.sharedCamera_My_3D_Chart___Test) {
            const plotDiv = document.getElementById('My_3D_Chart___Test');
            let isUpdating = false; // Prevent infinite loop

            plotDiv.on('plotly_relayout', (eventData) => {
                if (isUpdating) return; // Ignore events triggered by our own updates

                // Find which scene was updated
                for (let key in eventData) {
                    if (key.endsWith('.camera')) {
                        const newCamera = eventData[key];
                        window.currentCamera_My_3D_Chart___Test = newCamera;

                        // Apply to all scenes
                        isUpdating = true;
                        const updates = {};
                        facetValues.forEach((val, idx) => {
                            const sceneKey = idx === 0 ? 'scene' : 'scene' + (idx + 1);
                            updates[sceneKey + '.camera'] = newCamera;
                        });
                        Plotly.relayout(plotDiv, updates).then(() => {
                            isUpdating = false;
                        });
                        break;
                    }
                }
            });
        }
    }

    function renderFacetGrid_My_3D_Chart___Test(data, X_COL, Y_COL, Z_COL, COLOR_COL, FACET1_COL, FACET2_COL) {
        const facet1Values = [...new Set(data.map(row => row[FACET1_COL]))].sort();
        const facet2Values = [...new Set(data.map(row => row[FACET2_COL]))].sort();
        const rows = facet1Values.length;
        const cols = facet2Values.length;

        const traces = [];

        facet1Values.forEach((facet1Val, rowIdx) => {
            facet2Values.forEach((facet2Val, colIdx) => {
                const facetData = data.filter(row => row[FACET1_COL] === facet1Val && row[FACET2_COL] === facet2Val);
                if (facetData.length === 0) return;

                const idx = rowIdx * cols + colIdx;
                const sceneId = idx === 0 ? 'scene' : 'scene' + (idx + 1);

                const groups = {};
                facetData.forEach(row => {
                    const key = row[COLOR_COL];
                    if (!groups[key]) groups[key] = [];
                    groups[key].push(row);
                });

                Object.entries(groups).forEach(([key, groupData]) => {
                    traces.push({
                        x: groupData.map(d => parseFloat(d[X_COL])),
                        y: groupData.map(d => parseFloat(d[Y_COL])),
                        z: groupData.map(d => parseFloat(d[Z_COL])),
                        mode: 'markers',
                        name: key,
                        legendgroup: key,
                        showlegend: idx === 0,
                        scene: sceneId,
                        type: 'scatter3d',
                        marker: {
                            size: 4,
                            opacity: 0.6
                        }
                    });
                });

                if (window.showEigenvectors_My_3D_Chart___Test && facetData.length > 3) {
                    const eigData = computeEigenvectors(facetData, X_COL, Y_COL, Z_COL);
                    traces.push(...createEigenvectorTraces(eigData, sceneId));
                }
            });
        });

        const layout = {
            title: 'Testing Chart Title with Spaces',
            showlegend: true,
            grid: { rows: rows, columns: cols, pattern: 'independent' },
            annotations: []
        };

        // Create scene for each facet
        facet1Values.forEach((facet1Val, rowIdx) => {
            facet2Values.forEach((facet2Val, colIdx) => {
                const facetData = data.filter(row => row[FACET1_COL] === facet1Val && row[FACET2_COL] === facet2Val);
                if (facetData.length === 0) return;

                const idx = rowIdx * cols + colIdx;
                const sceneKey = idx === 0 ? 'scene' : 'scene' + (idx + 1);

                const xDomain = [colIdx / cols + 0.01, (colIdx + 1) / cols - 0.01];
                const yDomain = [1 - (rowIdx + 1) / rows + 0.01, 1 - rowIdx / rows - 0.01];

                layout[sceneKey] = {
                    domain: { x: xDomain, y: yDomain },
                    xaxis: { title: X_COL },
                    yaxis: { title: Y_COL },
                    zaxis: { title: Z_COL },
                    camera: window.sharedCamera_My_3D_Chart___Test ? (window.currentCamera_My_3D_Chart___Test || undefined) : undefined
                };

                // Column header
                if (rowIdx === 0) {
                    layout.annotations.push({
                        text: FACET2_COL + ': ' + facet2Val,
                        showarrow: false,
                        xref: sceneKey + ' domain',
                        yref: sceneKey + ' domain',
                        x: 0.5,
                        y: 1.05,
                        xanchor: 'center',
                        yanchor: 'bottom'
                    });
                }

                // Row header
                if (colIdx === 0) {
                    layout.annotations.push({
                        text: FACET1_COL + ': ' + facet1Val,
                        showarrow: false,
                        xref: sceneKey + ' domain',
                        yref: sceneKey + ' domain',
                        x: -0.1,
                        y: 0.5,
                        xanchor: 'center',
                        yanchor: 'middle',
                        textangle: -90
                    });
                }
            });
        });

        Plotly.react('My_3D_Chart___Test', traces, layout, {responsive: true});

        // Setup camera sync if shared
        if (window.sharedCamera_My_3D_Chart___Test) {
            const plotDiv = document.getElementById('My_3D_Chart___Test');
            let isUpdating = false; // Prevent infinite loop

            plotDiv.on('plotly_relayout', (eventData) => {
                if (isUpdating) return; // Ignore events triggered by our own updates

                // Find which scene was updated
                for (let key in eventData) {
                    if (key.endsWith('.camera')) {
                        const newCamera = eventData[key];
                        window.currentCamera_My_3D_Chart___Test = newCamera;

                        // Apply to all scenes
                        isUpdating = true;
                        const updates = {};
                        let sceneCount = 0;
                        facet1Values.forEach((f1, r) => {
                            facet2Values.forEach((f2, c) => {
                                const facetData = data.filter(row => row[FACET1_COL] === f1 && row[FACET2_COL] === f2);
                                if (facetData.length > 0) {
                                    const sceneKey = sceneCount === 0 ? 'scene' : 'scene' + (sceneCount + 1);
                                    updates[sceneKey + '.camera'] = newCamera;
                                    sceneCount++;
                                }
                            });
                        });
                        Plotly.relayout(plotDiv, updates).then(() => {
                            isUpdating = false;
                        });
                        break;
                    }
                }
            });
        }
    }

    window.updatePlotWithFilters_My_3D_Chart___Test = function() { updateChart_My_3D_Chart___Test(window.allData_My_3D_Chart___Test); };

    loadDataset('test_data').then(function(data) {
        window.allData_My_3D_Chart___Test = data;

        $(function() {
            

            // Initial plot
            updatePlotWithFilters_My_3D_Chart___Test();
        });
    }).catch(function(error) {
        console.error('Error loading data for chart My 3D Chart - Test:', error);
    });

    })();


});
</script>

<!-- DATASETS -->

<script type="text/plain" id="test_data" data-format="csv_embedded" data-src="">
x,y,z,category
2.976385137759061,1.363339463900046,0.4390666826842092,Group A
0.21424029306318004,-1.364807856958028,-1.8833851666424388,Group A
-1.3363269453256348,0.49647303177801594,1.1911707604621355,Group C
1.0956944128130381,0.017923829904800972,-0.06390211140403655,Group C
1.6292483349740643,-0.035971184607811506,0.3300907699342354,Group C
-1.2918569013304206,0.014826465985564167,-0.21733209700850678,Group A
-0.6029140760327479,-2.8211809254208644,-0.4190618059221064,Group C
0.5370687422874617,-1.8645626510297273,-0.53189785879845,Group A
2.3832915331783506,-0.641029594513852,0.17685507490455124,Group C
1.1695531264043222,1.2114021075415886,1.6698985817048706,Group A
-3.171249865522944,-0.04031512144336146,2.017064886387222,Group A
3.7224827354420826,0.7815664458159923,0.28471811504732075,Group C
-0.42616335959780505,0.5660324198274951,0.616767575947799,Group A
-1.4018251967318391,2.657521971786358,0.1318942643157677,Group B
-1.919541271375922,1.2318795529585143,0.4868589221993324,Group B
2.739568633180448,-0.6203430965702258,-0.3153145644870768,Group A
-0.8231041469716602,0.9606017163229867,-1.5010534477084891,Group A
-0.15097506169042624,0.15556423692262764,0.21772119018791405,Group B
-2.4122478917720285,1.520338580322091,0.2785866083577954,Group B
2.596000054436354,2.7973165991229045,-0.8343778832052604,Group B
0.1780341713375969,0.12809579001961865,-1.381475145048271,Group B
-1.1493386314690184,1.5606624892414227,-1.5545904910063257,Group A
1.5760589562416998,1.3114519261373645,-0.3990420235050724,Group B
0.45222315617835823,3.048961361669012,-0.14814331079091933,Group C
-3.1348371781816664,0.8663594321070902,-0.18308589110380785,Group A
-3.3058836435214745,1.0538868213909418,-0.5930739137912842,Group B
-0.7463824493160823,-0.09358365659784666,0.31856682060008357,Group B
-2.5126722096930716,-1.4562359167176238,1.5460579169921769,Group B
-4.14422634751341,2.8856130812336325,-0.7592783070722681,Group B
1.6757956675604992,-1.8988749477810352,-0.04913801478054262,Group A
0.029395688453984298,1.2806754099704805,0.18802776341661925,Group C
0.9321009375336134,0.4212087537278877,-0.49290902751526156,Group A
2.686727246196816,1.8030819323495282,0.2506053537190255,Group B
-0.04718584749813042,1.586280266725569,-0.8175221285341182,Group B
-0.16906480205641833,-0.25128997370307116,0.6425983679511493,Group B
0.7965044970579441,-0.11401436959115621,0.3238840793020324,Group C
0.31386924138712025,1.4980779792703558,-1.1332700257857147,Group B
3.419136974711011,-1.5727025558942802,1.0694717131780764,Group B
2.0754773437645686,0.970884128618813,1.434209469072114,Group B
-1.171490948826826,1.3774774336617344,0.8142618245787359,Group B
-1.2161933550388624,0.3708689581635666,-1.670809090293797,Group A
-1.4342437319842656,-2.448261358408933,0.3749348510929103,Group C
-2.354820301733836,-1.490928090308984,0.2440745865037889,Group C
0.3880781933139791,-0.6919550902728465,-0.45539302791765796,Group B
-0.07417305591466734,-2.8668696489534633,1.315459179878298,Group C
0.251032224282585,-3.9744054424984343,0.7161659404858404,Group B
-1.0772471256208185,-1.091538630457724,-0.5444980231744417,Group A
-0.8014177071611965,-0.693150162186833,-0.38167835903401964,Group A
-1.884791261665498,3.815575510178,-2.2710280511412853,Group C
0.531703016499488,1.647292003490267,0.4277754881289468,Group A
2.6642934570293977,1.7081329126332325,1.5689185037062225,Group C
-2.8205449367605544,0.18585529946651186,-0.32472720979478764,Group C
0.8567577312866851,1.8820500092602979,1.2245149493677,Group C
-1.0322060028061373,-0.6905206001974175,-0.777285653404999,Group B
-1.4375270957434216,0.819675369692239,1.0104573975413222,Group C
-1.324274590934839,0.4771799137562748,0.17153567348604068,Group C
-0.9190433102353638,-0.0856088614792391,-0.1618823527138413,Group A
-1.951935607801712,-0.43845608387945706,-0.8253513615484309,Group B
4.10912528935763,-0.4609612804058761,0.5531695628019553,Group C
0.15637683735082938,0.44272286008985046,-0.8397121531673067,Group B
-1.6049465555576239,0.693283800317789,-0.1183361967970231,Group C
1.4248600260152533,1.4541361355619848,-0.439768108397672,Group B
-0.3678080965532647,-1.0584995480638488,-1.5061372950285408,Group C
-1.6160324940668735,1.7826198367016337,-0.5562006377977093,Group B
-0.1315000968300361,-1.358010728258991,0.08647352635671143,Group C
-0.39485302065272354,1.8345382706966522,-0.02338343609021294,Group C
0.6192987899274875,0.6028567659700633,0.25358732382457716,Group C
-1.3998748597709791,3.7834850509490985,0.7196467773235035,Group A
-3.0049631976237716,-0.686120234663646,-0.43414384410302237,Group B
-0.7636822561376226,1.9845636406258222,-1.162170874071364,Group B
-0.08491489469482703,1.9793232898763446,0.038765262681427944,Group C
1.121581005961059,1.0397585353305914,-0.645546184966121,Group C
1.1969884630894498,-1.9538806213222113,-1.2999085476310097,Group A
1.1823898484549011,0.5482528921448507,1.35815287598207,Group A
-1.4359078050766774,1.045551242035244,0.5507571837972148,Group A
-2.005834140647988,-0.8447654625755948,-1.6496119927774575,Group B
-0.3159473063772718,-3.2319086961888184,0.045406651131818195,Group C
0.8957537065246667,1.499407374453172,-1.7766655320963776,Group C
1.6754297735521448,0.06763143113642081,0.6247126558489806,Group A
1.8239761822891278,0.1870389046318065,1.4294048426291008,Group B
1.0962077368780778,-2.134671992167164,-0.14798536280719346,Group B
-1.839412361322354,-2.5173125233729934,-0.07554410242044564,Group A
-1.677177788299388,0.013708060057776528,-1.704111867604888,Group C
0.3014643027170368,-3.2354649701090263,2.0516577085134036,Group A
0.06351788086134438,-1.015051605607573,-1.1724556685281613,Group C
-0.8776109351693574,-1.740623053177661,-1.4505210741335988,Group A
0.9485967608852824,0.7341007969212912,-1.5789254617518864,Group A
2.7681170001936177,0.547508888429936,-0.6345153067616921,Group A
0.794870273931533,1.6683518742077812,-0.6445361732409302,Group A
-0.5880071228713135,-2.275982918874089,0.6244771934570282,Group C
-0.7371663921417141,1.5543301259208717,-0.2346421908298709,Group B
2.3952991483847534,-0.7880001508314887,-0.4625447216642461,Group B
-4.269407569194245,-0.31878509961603424,-1.168154924024617,Group C
-0.262553495749039,3.0817644126450663,2.673815859503735,Group B
1.1988664658324963,0.8261467734897328,-0.9065034830474626,Group C
4.5475034427755565,-1.325907663422898,-0.7854355175860749,Group B
-2.24681369675181,1.544887784341968,0.04757651499526563,Group C
-3.5412134684232175,-0.3238463136913307,1.7621725048364527,Group C
3.5139541538547823,-0.36002354051991753,1.0822085355544027,Group B
0.908915032488015,0.2674330585638078,-0.24918719143857812,Group B
-0.22505640785078254,1.25154707125415,1.6975261676292361,Group C
-0.7652215328237202,0.3646405279702566,1.184249271817086,Group A
-2.0723668103762245,-1.5353162301861198,0.9254897737557114,Group C
0.569043640565924,-1.0380933311261722,-0.27496237870345136,Group B
3.5028880923798322,-0.049319321697593274,0.09851197640441042,Group A
2.5255505669761646,-0.5456549448435747,0.08458838379527295,Group A
3.3700742346755863,-1.4917582353286847,-0.19210731475642875,Group C
-1.510552259880649,2.3455529873065446,1.017338263275791,Group A
1.5940529093936882,0.2782325553410562,-1.2706539395001881,Group A
-1.6545842620071372,-1.4064608823390006,1.3168074077030911,Group C
2.4669458615987763,-0.7504472909440817,-0.16058084369161071,Group B
-1.8154345708026094,-6.139835335315878,0.21878400448680696,Group C
1.017812020412787,0.6266933762995783,-1.2776283747156116,Group B
2.464713051387325,-0.30839854353576013,-0.056119325269617375,Group C
0.3510615869603076,1.0954973926728153,-0.7212319030795388,Group C
-0.9587107788902894,1.8737777457813247,0.6680087683517538,Group B
-2.3288808412148563,0.6572803952016992,-1.3773542427462222,Group A
1.9645849641139506,-1.6426183475719367,1.4323317209258506,Group A
1.7147034549693674,-1.3379789098538928,0.898046240804229,Group A
-0.863949392518427,-1.2354560551268992,0.693258289220762,Group A
-4.707850989824449,-1.9130256017572642,0.4414638314878,Group A
-2.3056633876623396,-3.439403232639166,-0.5747080100835209,Group B
-1.5590250311331468,1.4466801497160526,-1.122526884306771,Group C
-4.2684650524040295,0.622002236301969,-0.18176950841412293,Group C
4.0782213829197556,-1.448839590985326,0.5188836627906946,Group B
-2.0915914419207198,-0.26471442872464546,-1.2929568278034107,Group B
1.4404557224146888,-0.8743563048364899,-0.261706022212609,Group A
0.5630081564419595,-1.266646562215944,-0.46599035998792004,Group A
1.9351812321177153,-0.11426956351368366,1.107747848786216,Group B
3.199411049453935,-2.1839784423179593,-0.5443214967186645,Group C
4.097930071369659,0.06562434346894369,-0.17774451917405765,Group A
-0.07024477789114454,-2.647822324885657,0.33012582696368914,Group B
2.322900450796129,1.082987133929326,-0.32622932148875017,Group B
-9.204957426449413,0.7206949923909916,-1.4679315331105358,Group B
3.9859585581349832,2.166153158023664,0.7148401656579452,Group B
-0.7211611400759086,1.4016242071255183,0.17856285612659667,Group B
0.438469927802471,0.7402916181669579,-1.00600514765576,Group A
0.2403526444591096,0.7111143515954872,-1.4311619080216722,Group A
-3.171608921222038,1.0270763748611487,0.430653416306901,Group A
1.0131304390764169,0.7624049434556631,0.928685061116619,Group B
-2.31736156497814,2.2528531403038126,1.1506431619651178,Group A
-0.017641541078739012,-1.3238021889173581,-0.6174104036144713,Group C
-3.1531880903727205,-0.981029268462682,-0.9743654082649976,Group B
-1.3641666563154338,-0.33773658379032434,-0.4666768894033359,Group B
-1.310614491655353,0.7863739502890288,-0.1477508745110024,Group A
1.2169114661970462,-0.00019369178719909908,0.0058298973721444755,Group A
-0.7574844689093038,0.055119049771945844,-0.9135096156442628,Group A
1.641449012889585,-3.253092264648859,-0.6345120308524064,Group A
0.16633130354152229,-2.239506892804985,1.140482876781124,Group C
2.4790902430315236,-1.4726179341248233,-1.3371435715463598,Group C
-2.678479967933751,0.9279831293188846,0.09839046105383216,Group C
-2.4902896359043423,-2.0906812987170755,-0.06213337004117259,Group A
0.3219062869516273,-2.10597543305199,0.10774474490244752,Group A
0.8657031810810701,1.5852214302764087,-0.19175009328709022,Group C
-4.875424410440432,-0.405073893598223,-0.9956331720722815,Group C
2.3309502115875484,-0.7629510021273029,-0.5292281969710683,Group A
-0.10998799196457704,0.9224812579521167,0.9711780317049789,Group C
-0.9165042480260337,-2.140764443645616,2.164074988609624,Group A
3.245269680013777,2.0375832427587453,0.5364990853068895,Group A
1.9308270046423708,0.08092572886420914,0.8312451304426095,Group A
-1.3616720318589146,-0.09228954089900317,0.5384926044158497,Group A
-0.7967587316363749,-0.4104272500541245,0.3540275331847231,Group C
1.5963918427750268,-1.0518561389886087,0.5646086905998736,Group A
4.475277081705487,-0.18762966091190433,2.1930631642975817,Group C
0.4685156982662671,1.5535281783976753,0.3224425667332942,Group A
-2.2690968260115887,1.9842927780745012,-1.7632988626921833,Group B
2.439859106215708,-1.4883171923446894,-1.766252833254175,Group A
-1.2158092541678691,-1.6820009013923214,0.6450417695020548,Group C
-3.14876867253307,-2.12432957213794,2.289981018906498,Group A
-1.6062254447615596,-1.5184515386862762,-0.7298533504808303,Group B
-2.2780963193217207,-0.9157582979585346,0.23297132359106282,Group B
-1.224731541307347,-0.23690195073871334,0.4290144800222983,Group A
-2.0323768813520786,-0.1891359133518009,-0.23361753116661135,Group B
0.34826877695213315,0.6680845709794635,-1.107696767172039,Group A
3.112173664580102,0.2756148494116467,-0.4222631814997169,Group C
-0.07441149263015656,0.41623442580780645,-0.8161246009946655,Group C
1.1319518058081726,2.5305211634695035,1.172812104489133,Group B
1.3280571134530619,2.3023176241517733,-1.4000321104034972,Group C
1.5724526548585742,-0.5745267104358527,-0.42844052307367597,Group C
0.9399173480997307,0.24951566211292803,-1.263528202114726,Group B
-0.8151116923509782,-0.33219654129464843,1.728197476045992,Group B
1.7359534244467967,-1.3201374903322027,0.19655688129295765,Group A
2.1075678836437817,-0.12777104782914256,-0.941890238896163,Group B
-1.0825203904053486,-1.5244863713598882,-0.6060695606784741,Group C
-1.3696046602596563,-0.6127763123474047,0.28127424672182666,Group A
1.3093752676042412,1.067234236983293,1.0554951482839257,Group B
-1.7153655530044112,0.21970279817415533,-1.1633216928659744,Group B
-2.287773002258648,-1.3062600679201233,1.4957219054904975,Group C
-2.9608102589905543,-0.503390422322717,-1.430645362436166,Group B
0.6865721461168799,0.5636763405029189,-0.552561689249248,Group A
2.6542604961638805,-0.8286423345253344,0.44035332436401725,Group A
0.3392664669682804,-0.4485060120558607,-0.42905235294718086,Group B
-2.502870227175087,0.2695345548280458,-0.3377180420204678,Group C
0.5024111545033985,-3.996043880464934,-0.6778660088200011,Group C
0.9777389123483977,1.7706839216929868,-0.412450246659429,Group A
-2.033064252894318,1.7787963502258037,-0.21323891511809606,Group B
2.414773915117066,1.787419829896034,-0.6548228932748773,Group A
-0.0592775733073844,0.20841672270689054,-1.4738124443549354,Group C
3.698019546982627,-0.9924915040564916,-0.8246519474907166,Group B
-3.215687891581854,0.6585422386072028,0.08063222269665636,Group C
2.503340221015236,0.19625714530638116,-0.4524677800014189,Group C
1.4007320138840307,-1.8774564650568415,0.7511912909555774,Group A
0.40274848615859615,0.3221852109483809,-0.06378162040011869,Group C
0.46212465603773295,-0.4832423618120516,0.7358551210867175,Group C
-0.3961331521023537,-0.2848248661613396,-0.6347102657355438,Group B
1.1711239625974357,0.2847060773687314,-0.6047541882157942,Group B
-0.9749927478324324,0.15570412694137375,-0.6288965934557096,Group B
0.6207952321477693,0.16207275557500325,-0.41702832662069256,Group A
0.8249643832024272,-1.1149393285852387,0.4591528926887315,Group A
1.6102697614354893,-0.993779100994453,-0.18944654827853954,Group A
-0.14502592785340343,0.9582775067391255,-1.7295365955081943,Group C
-1.1697969486053341,-0.2689000617144649,1.0016799936918992,Group B
-1.3597177533909148,2.853140265723085,0.47995990295603563,Group B
1.2622396414445247,-0.2554031478782778,-0.66749547473412,Group B
-0.2862560038352296,0.6493064921205659,-0.37090886797482064,Group C
2.31562532992583,3.3103254405964178,0.480611159920068,Group A
3.3013419824613957,1.1597357123754022,-0.28794130174384436,Group C
-0.5429186106434932,-0.3128615275799858,-1.3757628961393344,Group A
-2.6177619885880223,0.62267995774278,0.07763437230928873,Group B
-1.4602387677635118,0.5613817164958436,-0.5975725130882185,Group B
4.619093785140673,-0.14832946691944143,-1.4644891114396885,Group A
-1.6166713464602838,0.40022664415117404,1.2526066460162766,Group B
-0.6688337068256974,-0.5966826266987242,-0.6374405198522806,Group B
3.0066196619765595,-0.35657329195708287,-1.5676912683162656,Group C
-3.4404297278939198,0.32067335293681615,-0.688762171610578,Group C
0.9873583599992533,-1.3829041124732053,0.30759812624172705,Group B
-1.536808129550894,-0.7446504625051582,0.023923969621551695,Group B
0.6198031458021398,2.352424661962004,0.2016703444242161,Group C
-1.9847863087583184,-0.323658708422799,2.845121267255918,Group B
-3.8717939058432322,0.04125203123158824,-3.156639373585895,Group B
-0.6352010605831072,2.0296654626773667,-0.07246428007368834,Group A
0.3995592332663297,0.38917271580785284,0.7325561336255402,Group A
0.32598769672123923,0.9286346490888747,2.6982122086530618,Group A
-0.5694401767978238,0.859233955021427,0.20986598159736145,Group B
1.316854937935472,1.8137000356241564,0.42247359587981576,Group B
4.882318547667299,0.9823208116373818,-1.7816054837814628,Group B
2.8221108551637655,0.05291039506550107,-1.0228455175295976,Group A
2.140730968210213,1.2113042628293065,1.2006620397931658,Group A
-0.28756769076045363,1.1963361566567765,0.8146446393586428,Group C
2.51311886294089,0.515217616393336,0.7923638803216491,Group C
4.323504646594461,-0.32437949217878775,0.2170235633315388,Group A
-0.24230826576518197,2.514097744204871,0.2716740304159756,Group A
4.68889938622272,2.3299406273027508,-0.35691298193205045,Group C
-4.785280993989004,2.3536552660108216,1.1470842626573707,Group C
-1.4779009219903136,-0.6656574441055951,1.176111950275733,Group A
1.5013837803097605,-2.6477153416765886,-1.2383788311596886,Group C
-2.3257234265196143,-0.6116299888430257,-1.521256109212116,Group A
3.4248855837799947,1.3974316073699442,0.841986358534107,Group A
-0.8766568852668739,-0.7842408690182716,0.4199890883015702,Group B
2.212962663319541,3.326337008837222,1.7807747227919497,Group C
4.283448320638432,0.3552237041231311,-0.7760510415050357,Group A
-2.906211739949685,-1.3247787433730978,1.2095498337335722,Group B
3.2492090521299763,-0.5442140392226338,1.6560864236773167,Group B
2.4196328603032433,-1.1293694579634392,-0.4054621633628967,Group A
-0.04926718786149931,-0.8310957894306882,0.3437656983118863,Group A
-1.530998404927347,0.6146197078289475,1.5523254615507407,Group A
-0.26103255092417715,1.4900320575835502,-1.597308877727016,Group B
-0.5964399703969119,-1.4092942378793516,-0.23007681401553154,Group B
0.42678544830020115,-3.90568625182324,-0.44034961660824906,Group C
-0.25622976396107733,-0.6917347749074838,-0.12414041849988494,Group B
0.1012217901402568,0.3841610329834345,-0.49306973823378547,Group A
-2.113720153845413,0.9342546099770352,-0.11768665747653888,Group A
3.796582105745244,0.47081907310032356,-0.2877877423497042,Group C
-0.8678568178814999,-1.179716763459087,-0.37724388487928634,Group A
0.5565893925797619,-1.414395009838866,0.17418899523130238,Group C
2.379555527407275,-1.2843407020509556,1.5608284883313903,Group A
-1.831705732477121,0.7750705906824309,-0.23514447210420206,Group B
-1.4383771243441354,2.1056925510333766,0.9755600401099371,Group C
-1.9765571558549542,1.2026979294009226,0.12315619185135034,Group C
0.15398795778675656,-1.6082926520322594,0.4612103612434771,Group C
4.336304203101747,-1.3040948859030328,-2.0428518642555438,Group B
0.225465539486336,2.499433040914351,0.9580500067381943,Group B
-0.023618988323248064,-0.8593994392125698,-1.587325367638266,Group A
-0.6461178742163358,-1.2277078590966894,0.9478660111481405,Group C
1.9338524749118255,1.9821486474836996,-2.0314670146355014,Group C
0.9861281948582458,-2.0123273456566033,1.9387087079694474,Group B
0.2308762828806549,2.3834099184969526,1.0425685892258019,Group A
0.6807334691418074,0.9916343207637714,-2.3288954581069072,Group B
-3.4409109704831904,1.8003735518170005,-2.0258268336697,Group B
0.44429839134912347,-0.08431171613071312,-1.5470666550897967,Group C
-2.091449296526183,0.46461098881455365,0.42304763775007825,Group B
-0.07395231613589245,1.8399167259490596,0.05693827257832635,Group B
-3.122188809684547,2.1464406618264658,0.6264618613467999,Group C
-2.7906746555427215,0.9682621261827006,1.5204722885556792,Group B
3.58477713959479,-1.9200746967781845,2.609433024797717,Group A
-0.3913888742161016,2.105804893118885,1.3305621445900673,Group B
-0.09196917940712439,1.3516627902238874,0.2270898718387851,Group C
-2.0841946616123304,-0.06641927836398315,0.9129134447910086,Group A
-2.319129123546036,-1.7552185906447388,1.028233476795131,Group C
1.553996009109903,-1.88328864409941,0.9191949218734189,Group A
-3.6254402840102746,-0.3310520266429934,2.6713733537167395,Group C
-2.1000465856929997,-0.5016335325345911,0.2483099806243717,Group A
-2.8927185403474245,1.1140000924616842,0.47672533484902807,Group A
-0.7817166919926436,-2.7800036335403915,0.1778860058667262,Group C
-0.9843063727688944,2.9141807347508593,2.4254875087016226,Group A
2.0798985085881943,1.3926616424446614,1.1052046119780696,Group A
-4.288972599729395,2.998764030371568,1.3393488001953762,Group A
-1.4857959826394125,-1.859925729855461,1.4797784472142521,Group B
3.032712861082995,0.4403859561056099,1.0943812835404414,Group B
0.3588995312904986,-2.694665388185885,-1.116705318508607,Group A

</script>

<!-- ACTUAL CONTENT -->

<h1></h1>
<p></p>

<h2>Testing Chart Title with Spaces</h2>
<p>This chart title contains spaces, hyphens, and special characters</p>

<!-- Filters (for data filtering) -->


<!-- Plot Attributes -->
<div style="margin-bottom: 15px; padding: 10px; border: 1px solid #ddd; background-color: #f0f8ff;">
            <h4 style="margin-top: 0;">Plot Attributes</h4>
            <div style="margin: 10px 0; display: flex; gap: 10px; align-items: center;">
    <button id="My_3D_Chart___Test_eigenvector_toggle" style="padding: 5px 15px; cursor: pointer;">
        Hide Eigenvectors
    </button>
</div>
<div style="margin: 10px 0; display: flex; gap: 20px; align-items: center;">
                <div style="display: flex; gap: 5px; align-items: center;">
                    <label for="My_3D_Chart___Test_x_col_select">X:</label>
                    <select id="My_3D_Chart___Test_x_col_select" onchange="updatePlotWithFilters_My_3D_Chart___Test()">
                    <option value="x" selected>x</option>
                    <option value="y">y</option>
                    <option value="z">z</option>                </select>
                </div>
                            <div style="display: flex; gap: 5px; align-items: center;">
                    <label for="My_3D_Chart___Test_y_col_select">Y:</label>
                    <select id="My_3D_Chart___Test_y_col_select" onchange="updatePlotWithFilters_My_3D_Chart___Test()">
                    <option value="x">x</option>
                    <option value="y" selected>y</option>
                    <option value="z">z</option>                </select>
                </div>
                            <div style="display: flex; gap: 5px; align-items: center;">
                    <label for="My_3D_Chart___Test_z_col_select">Z:</label>
                    <select id="My_3D_Chart___Test_z_col_select" onchange="updatePlotWithFilters_My_3D_Chart___Test()">
                    <option value="x">x</option>
                    <option value="y">y</option>
                    <option value="z" selected>z</option>                </select>
                </div>
                    </div>

        </div>

<!-- Faceting -->


<!-- Chart -->
<div id="My_3D_Chart___Test"></div>
<br><p style="text-align: right; font-size: 0.8em; color: #666; margin-top: -10px; margin-bottom: 10px;">Data: test_data</p>

<hr><p align="right"><small>This page was created using <a href="https://github.com/s-baumann/JSPlots.jl">JSPlots.jl</a>.</small></p>
</body>
</html>
